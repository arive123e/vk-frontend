<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>햎햟햡햦혢햣혜햨햦햧 쮐혝햟햩 햟쒬쮐햦향햟혡햦햦 VK ID</title>
    <script src="https://unpkg.com/@vkid/sdk@2.5.2/dist-sdk/umd/index.js"></script>
</head>
<body>
    <h1>햆쮏쐄 쮏웷썛쮏쒫썜혧!</h1>
    <!-- 游댳 햌쮏쫨햣햧햫햣 햢햩혪 VK SDK 햨햫쮏햨햦 -->
    <div id="vkid_container"></div>
    
    <script>
        setTimeout(function () {
            if ('VKIDSDK' in window) {
                const VKID = window.VKIDSDK;

                // 쮏혞혢햣햫햦햣 tg_id 햦향 query-햟햟햪햣혝쮏
                function getTelegramId() {
                    const urlParams = new URLSearchParams(window.location.search);
                    return urlParams.get('tg_id') || '';
                }
                const tg_id = getTelegramId();
                
                // === 游댌 햍쮏햦 햢햩혪 쮏쒫왐햨햦 ===
                console.log("游릭 VKID redirectUrl:", 'https://api.fokusnikaltair.xyz/auth/vk/callback');
                console.log("游릭 VKID state (tg_id):", tg_id);

                VKID.Config.init({
                    app: 53336238,
                    redirectUrl: 'https://api.fokusnikaltair.xyz/auth/vk/callback',
                    responseMode: VKID.ConfigResponseMode.Callback,
                    source: VKID.ConfigSource.LOWCODE,
                    scope: 'friends,groups,wall,docs,photos,video,email,offline',
                    state: tg_id,
                    usePkce: true
                });
                
                const oneTap = new VKID.OneTap();

                const container = document.getElementById('VkIdSdkOneTap');

                if (container) {
                oneTap.render({
                    container,
                    styles: {
                    height: 40,
                })
                .on(VKID.WidgetEvents.ERROR, vkidOnError);

                function vkidOnError(error) {
                    alert('뤰걣쟳쐃쥃 햟쒬쮐햦향햟혡햦햦: ' + (error?.message || error));
                }
            } else {
                console.error('VKID SDK 햏햇 향햟햡혞햤햣햫! 뉋쟳얧웷왐 햫햣 쮐햦혜쮏쒫썛.');
            }
        }, 2000); // 향햟햢햣햤햨햟 햢햩혪 향햟햡혞향햨햦 SDK
    </script>
</body>
</html>
