<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ú–∞–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ VK ID</title>
    <script src="https://unpkg.com/@vkid/sdk@2.5.2/dist-sdk/umd/index.js"></script>
</head>
<body>
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
    <div id="vkid_container"></div>
    <script>
        setTimeout(function () {
            if ('VKIDSDK' in window) {
                const VKID = window.VKIDSDK;

                // –ü–æ–ª—É—á–µ–Ω–∏–µ tg_id –∏–∑ query-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
                function getTelegramId() {
                    const urlParams = new URLSearchParams(window.location.search);
                    return urlParams.get('tg_id') || '';
                }
                const tg_id = getTelegramId();
                
                // === üîç –î–û–ë–ê–í–õ–ï–ù–ù–´–ï –õ–û–ì–ò –î–õ–Ø –ü–†–û–í–ï–†–ö–ò ===
                console.log("üü¢ VKID redirectUrl:", 'https://api.fokusnikaltair.xyz/auth/vk/callback');
                console.log("üü¢ VKID state (tg_id):", tg_id);

                VKID.Config.init({
                    app: 53336238,
                    redirectUrl: 'https://api.fokusnikaltair.xyz/auth/vk/callback', // ‚Üê —Ç–≤–æ–π backend
                    responseMode: VKID.ConfigResponseMode.Callback,
                    source: VKID.ConfigSource.LOWCODE,
                    scope: 'friends,groups,wall,docs,photos,video,email,offline',
                    state: tg_id
                });

                const oneTap = new VKID.OneTap();

                oneTap.render({
                    container: document.getElementById('vkid_container'),
                    showAlternativeLogin: true
                })
                .on(VKID.WidgetEvents.ERROR, vkidOnError);

                <a 
                  href="https://api.fokusnikaltair.xyz/auth/vk"
                  style="display: inline-block; background-color: #07f; color: white; padding: 12px 20px; border-radius: 6px; text-decoration: none; font-family: sans-serif; font-size: 16px;"
                >
                  üîë –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ VK (–±–µ–∑ SDK)
                </a>


                function vkidOnError(error) {
                    // –ü–æ–∫–∞–∂–∏ –æ—à–∏–±–∫—É –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ –∏–ª–∏ —Å–¥–µ–ª–∞–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    alert('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ' + error?.message || error);
                }
            } else {
                console.error('VKID SDK –ù–ï –∑–∞–≥—Ä—É–∂–µ–Ω! –í–∏–¥–∂–µ—Ç –Ω–µ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω.');
            }
        }, 1000); // –ñ—ë—Å—Ç–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ SDK
    </script>
</body>
</html>
