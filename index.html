<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Фокусник Альтаир — Авторизация через VK ID</title>
  <script src="https://unpkg.com/@vkid/sdk@2.5.2/dist-sdk/umd/index.js"></script>
  <style>
    body { font-family: system-ui, sans-serif; padding: 40px; }
    .wrap { max-width: 400px; margin: 0 auto; }
    h1 { font-size: 2em; margin-bottom: 0.5em; }
    #VkIdSdkOneTap { margin-top: 20px; }
    .error { color: #c00; margin-top: 30px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Фокусник Альтаир</h1>
    <p>Для доступа к сервису авторизуйтесь через VK ID:</p>
    <div id="VkIdSdkOneTap"></div>
    <div id="error" class="error"></div>
  </div>
  <script>
    // Получаем Telegram ID из query (?tg_id=...)
    function getQueryParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }
    const tg_id = getQueryParam('tg_id');
    if (!tg_id) {
      document.getElementById('error').textContent = 'Ошибка: Telegram ID не передан! Пожалуйста, перейдите по правильной ссылке из Telegram-бота.';
      throw new Error('tg_id обязателен');
    }
    // Инициализация VK ID SDK One Tap
    if ('VKIDSDK' in window) {
      const VKID = window.VKIDSDK;
      VKID.Config.init({
        app: 53336238,
        redirectUrl: 'https://api.fokusnikaltair.xyz/auth/vk/callback', // Твой редирект
        state: tg_id, // Telegram ID, прилетит на backend в query/state
        scope: 'groups', // по необходимости
      });
      const oneTap = new VKID.OneTap();
      oneTap.render({ container: document.getElementById('VkIdSdkOneTap') });
    } else {
      document.getElementById('error').textContent = 'Ошибка загрузки VKID SDK!';
    }
  </script>
</body>
</html>
