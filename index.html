<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>VK Авторизация</title>
    <script src="https://unpkg.com/@vkid/sdk@2.5.2/dist-sdk/umd/index.js"></script>
    <style>
      body {
        background: #0d122b;
        color: #fff;
        font-family: 'Montserrat', Arial, sans-serif;
        text-align: center;
        padding: 60px 20px;
      }
      .magic {
        font-size: 2em;
        color: #f9d923;
        text-shadow: 0 0 12px #fff47a, 0 0 20px #a7c7e7;
        margin-bottom: 40px;
      }
    </style>
</head>
<body>
    <div class="magic">Магический портал авторизации через VK</div>
    <div id="vkid-container"></div>
    <div id="result"></div>

    <script>
        // Получаем tg_id из адреса страницы (если есть)
        const urlParams = new URLSearchParams(window.location.search);
        const tg_id = urlParams.get('tg_id') || '';

        VKID.Config.init({
            app: 53336238,
            redirectUrl: 'https://vk-backend-w0we.onrender.com/auth/vk/callback?tg_id=' + encodeURIComponent(tg_id),
            responseMode: VKID.ConfigResponseMode.Callback,
            source: VKID.ConfigSource.LOWCODE,
            scope: '',
        });

        const oneTap = new VKID.OneTap();

        oneTap.render({
            container: document.getElementById('vkid-container'),
            showAlternativeLogin: true,
        })
        .on(VKID.WidgetEvents.ERROR, (error) => {
            document.getElementById('result').innerHTML = "<div style='color: red;'>Ошибка: " + error.message + "</div>";
        });
    </script>
</body>
</html>
